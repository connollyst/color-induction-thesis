
%% bare_jrnl.tex
%% V1.4
%% 2012/12/27
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8 or later) with an IEEE journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%% and
%% http://www.ieee.org/



% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the test flow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. IEEE's font choices can trigger bugs that do  ***
% *** not appear when using other class files.                            ***
% The test flow support page is at:
% http://www.michaelshell.org/tex/testflow/


%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%
%% File list of work: IEEEtran.cls, IEEEtran_HOWTO.pdf, bare_adv.tex,
%%                    bare_conf.tex, bare_jrnl.tex, bare_jrnl_compsoc.tex,
%%                    bare_jrnl_transmag.tex
%%*************************************************************************

% Note that the a4paper option is mainly intended so that authors in
% countries using A4 can easily print to A4 and see how their papers will
% look in print - the typesetting of the document will not typically be
% affected with changes in paper size (but the bottom and side margins will).
% Use the test flow package mentioned above to verify correct handling of
% both paper sizes by the user's LaTeX system.
%
% Also note that the "draftcls" or "draftclsnofoot", not "draft", option
% should be used if it is desired that the figures are to be displayed in
% draft mode.
%
\documentclass[journal,onecolumn]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}





% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/tex-archive/macros/latex/contrib/oberdiek/
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.
\usepackage{enumitem}
% enumitem enables enumerations with letters
\usepackage{threeparttable}
% threeparttable for tables with both captions and notes




% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% no adjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 4.0 (2003-05-27) and later if using hyperref.sty. cite.sty does
% not currently provide for hyperlinked citations.
% The latest version can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/cite/
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\usepackage{graphicx}
% declare the path(s) where your graphic files are
\graphicspath{{images/}}
% and their extensions so you won't have to specify these with
% every instance of \includegraphics
\DeclareGraphicsExtensions{.pdf,.jpeg,.png}
% graphics was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/tex-archive/macros/latex/required/graphics/
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/tex-archive/info/epslatex/
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}

% TikZ enabled us to draw graphics directly in LaTeX
\usepackage{color}
\definecolor{alizarin}{RGB}{231, 76, 60}
\definecolor{pomegranate}{RGB}{192, 57, 43}
\definecolor{emerald}{RGB}{46, 204, 113}
\definecolor{turquoise}{RGB}{26, 188, 156}
\definecolor{greensea}{RGB}{22, 160, 133}
\definecolor{peter}{RGB}{52, 152, 219}





% *** MATH PACKAGES ***
%
\usepackage[cmex10]{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics. If using
% it, be sure to load this package with the cmex10 option to ensure that
% only type 1 fonts will utilized at all point sizes. Without this option,
% it is possible that some math symbols, particularly those within
% footnotes, will be rendered in bitmap form which will result in a
% document that can not be IEEE Xplore compliant!
%
% Also, note that the ams math package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading ams math to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/required/amslatex/math/





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment of describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/algorithms/
% There is also a support site at:
% http://algorithms.berlios.de/index.html
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/tex-archive/macros/latex/contrib/algorithmicx/




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/required/tools/
\usepackage{float}


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/subfig/
\usepackage{subcaption}
% Use subcaption instead of subfig (deprecated)



% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unlatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure. The latest version and documentation can be found at:
% http://www.ctan.org/tex-archive/macros/latex/base/


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/sttools/
% Do not use the stfloats baseline float ability as IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/dblfloatfix/




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captions off option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the no markers option of end float to
% prevent end float from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the end float docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the sub captions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and end float does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/endfloat/
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/tex-archive/macros/latex/contrib/url/
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as psalter).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}


\begin{document}

\title{Introduction of a Biologically Plausible \\ Color Descriptor to a Neurodynamical Model \\ of the Primary Visual Cortex}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

\author{Sean Thomas Connolly% <-this % stops a space
\thanks{Author: Sean Thomas Connolly, connolly.st@gmail.com}% <-this % stops a space
\thanks{Advisor: Xavier Otazu,  Computer Vision Center, Computer Science Department, Universitat AutÃ²noma de Barcelona, Barcelona, Spain }% <-this % stops a space% stops a space
\thanks{Submitted: September 2014}}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
\markboth{Master Thesis Dissertation, Master in Computer Vision, July 2014}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}
% The only time the second header will appear is for the odd numbered pages
% after the title page when using the two side option.



% make the title area
\maketitle


\begin{abstract}
We present a computational model of color description \& processing in the primary visual cortex (V1), inspired by current neurobiological understanding. This understanding posits single and double opponent neurons as fundamental to low level color processing. We offer a novel representation of color by defining these cells' responses and the connections between them, within the framework of a dynamical model of neuronal activity. Our model reproduces perceptual experiences in a number of cases, offering credence to said biological theories.
\end{abstract}

% Note that keywords are not normally used for peer review papers.
\begin{IEEEkeywords}
primary visual cortex, striate cortex, V1, receptive field, single-opponent, double-opponent, color assimilation, color induction
\end{IEEEkeywords}


% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peer review papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle



\section{Introduction}

% TODO perhaps the distinction between physical color and perception color is valuable here?

\IEEEPARstart{C}{olor} induction and contrast are two related, opposing, perceptual phenomena. The former is a change in perceived color "toward" a nearby color, while the latter is a change of one color "away" from the nearby color. Neurophysiological research suggests that these phenomena may arise as early in primate vision as the primary visual cortex (V1). It is proposed that the boundaries between two colored regions drive these effects. Specifically, research in the field describes neurons which fire selectively to boundaries between certain colors, so called double-opponent cells, and identifies them as being critically related to the color perceived.

Within, we propose a computational model designed around the current understanding of this biology. We present two implementations, one more biologically accurate, and another more computationally elegant. We explore the behavior of these models with respect to what they can teach us about the assumed biological theories, as well as their application to the field of computer vision.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% STATE OF THE ART
%
% A bibliographic review on of the problem topic.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{State of the art}


\subsection{Neurobiology}

Historically, it was widely believed that color and shape are two distinct aspects of visual perception. Truly, this line of though is intuitive: one can perceive the color of a flat surface which occupies our full field of vision, despite its lack of 'shape', likewise we can see the shape of achromatic objects, as in black and white film. This theory of perception innervated neurophysiological understanding and was supported by neurobiological findings, such as that the lateral geniculate nucleus (LGN), the pathway which carries information from the retina to the primary visual cortex (V1), consists of three entirely distinct layers; two (the parvicellular and konicellular) carrying only color information, and one (the magnocellular) dealing purely in achromatic contrast (edge) information. Based on early anatomical observations, it was proposed that these three LGN pathways for color and contrast are then processed into two separate streams in V1, one for color and the other for form. This separate handling of color and form confirmed for researchers that, as suspected, these two perceptual concepts are processed separately in the brain.

Research in the past decade or so has seen a shift from this thinking, however. Psychophysical observations, such as those in Figure \ref{fig:blur-effect}, influenced researchers to consider that color and form are more intrinsically related than previously thought. In these examples, we see that the perceived color of the inner square is highly dependent on the background and, most importantly, how the inner square \textit{contacts} the background. That is to say, the color perceived is not just determined by the physical properties of the surface itself, but also by the context in which the surface is viewed. Furthermore, we can observe that this contextual influence comes largely from the boundary edges of the surface: in example (c), the dulling color assimilation effect witnessed in (b) is almost entirely negated by simply adding a thin border. That is, by removing contact between the inner square and the background, the effect of the context is significantly reduced. In fact, "the color appearance of a region may be more dependent on color contrast at the boundary of the region than it is on the spectral reflectance of the region's interior." \cite[p.572]{chualupa:encyclopedia}

\begin{figure}[H]
    \centering
    \begin{subfigure}{0.25\textwidth}
        \centering
        \includegraphics[width=100pt]{example_1a}
    \end{subfigure}%
    \begin{subfigure}{0.25\textwidth}
        \centering
        \includegraphics[width=100pt]{example_1b}
    \end{subfigure}%
    \begin{subfigure}{0.25\textwidth}
        \centering
        \includegraphics[width=100pt]{example_1c}
    \end{subfigure}%
    \begin{subfigure}{0.25\textwidth}
        \centering
        \includegraphics[width=100pt]{example_1d}
    \end{subfigure}%
    \caption{Psychophysical example emphasizing the effect of edge contrast in color perception. In all cases, the center square is the same physical color. On (a) the green background, however, it appears much brighter than it does on (b) the red background. (c) Adding a thin black border negates the assimilation effect, increasing the perceived brightness of the center square. (d) Blurring the background, on the other hand, seems to enhance assimilation, lowering the perceived brightness at the center.}
    \label{fig:blur-effect}
\end{figure}

With these psychophysical observations in mind, much research has been devoted to elucidating the exact neurobiological mechanisms behind the perception of color, and the influence of form in it. The current view holds that while the LGN does indeed carry color and contrast information through separate pathways to V1, once there, color and form become deeply intertwined as they are processed further. To explain the simultaneous processing of color and form in V1, the literature proposes two broad classifications of neurons: single-opponent cells, \& double-opponent cells (Johnson et al. Color and Orientation in V1).

Opponency, in neurobiology, refers to antagonistic inputs of information: one source of input excites the neuron, while another inhibits it. These two antagonistic components of opponency are commonly referred to as the \textit{on} and \textit{off} inputs to a neuron. One can think of these two inputs as being what the cell is 'looking for', \textit{on}, and what the cell is 'not looking for', \textit{off}. Intuitively, stimuli from the \textit{on} input excites the neuron, while stimuli from the \textit{off} input inhibits it. Perhaps less intuitively, removal of stimuli from the \textit{off} input also excites the neuron. This behavior is logical when you consider that the two antagonistic inputs typically represent mutually exclusive features. In this way, removal of the negative stimuli often means much the same as presence of the positive stimuli and thus, removal of such stimuli can contribute to excitation of the neuron. Of course, if equal stimuli are provided from both the \textit{on} and \textit{off} inputs, excitation is cancelled out by inhibition and the neuron does not fire. Lastly, recognize that any one neuron usually receives antagonistic input from, in fact, many other neurons. The aggregate stimuli from these excitatory and inhibitory input determines if the cell fires.

With respect to cells in the early visual system, we specifically use opponency to refer to chromatic and spatial opponency. We will now detail what this means, with specific examples of neurons' expected responses to various stimuli, as well as the implications of such response patterns. Briefly, however, consider that single-opponent cells respond best to large areas of color, while double-opponent cells respond only to the boundaries between such areas.


\subsection*{Single-Opponent Neurons}

Single-opponent cells are a class of neurons in the early visual system which respond best to large areas of color and/or luminance. Their behavior is achieved by constructing classical center-surround receptive fields. The center receptive field serves as the \textit{on} input, exciting the cell when presented with a particular color, while the surround receptive field serves as the \textit{off} input, inhibiting the cell when another color is present or exciting it when that color is \textit{removed}. These center and surround receptive fields may involve very few retinal cones, or may span many degrees of vision [cite Haake].

In so called color preferring single-opponent cells, the cone inputs to the center and surround come from cones with different spectral response functions. By arranging input from different cones into antagonistic  receptive fields, we get a neuron which is sensitive to a particular 'opponent color'. In the human visual system, we recognize three axes of color opponency: redness vs. greenness, blueness vs. yellowness, and lightness vs. darkness. To construct such concepts of color, neurons in the visual pathway contrast activity of the three types of cone cells: those sensitive to long (L) wavelength light, those sensitive to medium (M) wavelength light, and those sensitive to short (S) wavelength light. By contrasting relative activity with neighboring L, M, and S cones, the retina itself can already begin to construct signal resembling psychological concepts of 'color'.

\textbf{//TODO} \textit{add image of simple behavior: gradient response to isoluminant chromatic boundary}

\textbf{//TODO} \textit{add image of simple behavior: no response to intensity changes}

\textbf{//TODO} \textit{add image of ON/OFF differences: R-G cell responds to fullscreen green light removed (not red removed)}

% FIGURE: Single-opponent receptive field schematics
\begin{figure}[H] \label{fig:so-rf-schematic}
    \centering
    \captionsetup{justification=centering}
    % 3 SUBFIGURES: Cross sections of single-opponent receptive fields
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[color=pomegranate!80, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-1.00, 0.00) .. controls (-0.30,-0.05) .. (-0.05,-2.00);
            \draw[color=greensea,       very thick] (-0.05,-2.00) .. controls ( 0.00,-2.10) .. ( 0.05,-2.00);
            \draw[color=greensea,       very thick] ( 1.00, 0.00) .. controls ( 0.30,-0.05) .. ( 0.05,-2.00)
                 node[color=black, anchor=north west] {$M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[color=pomegranate!80, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-1.00, 0.00) .. controls (-0.30,-0.05) .. (-0.05,-1.00);
            \draw[color=greensea,       very thick] (-0.05,-1.00) .. controls ( 0.00,-1.10) .. ( 0.05,-1.00);
            \draw[color=greensea,       very thick] ( 1.00, 0.00) .. controls ( 0.30,-0.05) .. ( 0.05,-1.00)
                 node[color=black, anchor=north west] {$M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[color=pomegranate!80, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[color=greensea,       very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[color=greensea,       very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}%
    \par \bigskip
    % 3 SUBFIGURES: Top-down view of double-opponent receptive fields
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            % Frame to ensure alignment:
            \draw[color=white]                                         ( 0.00, -1.00) --     (0.00, 1.00);
            \filldraw[color=greensea,    fill=alizarin!70,  very thick]( 0.00,  0.00) circle (0.70)
                 node[color=black,       anchor=south] {$\scriptstyle L^+$}
                 node[color=black,       anchor=north] {$\scriptstyle M^-$};
            \filldraw[color=black,       fill=gray]                    ( 0.00,  0.00) circle (1pt);
        \end{tikzpicture}
        \caption{Symmetric \\ balanced \\ single-opponent \\ receptive field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            % Frame to ensure alignment:
            \draw[color=white]                                         ( 0.00, -1.00) --     (0.00, 1.00);
            \filldraw[color=greensea,    fill=alizarin!70,  very thick]( 0.00,  0.00) circle (0.70)
                 node[color=black,       anchor=south] {$\scriptstyle L^+$}
                 node[color=black,       anchor=north] {$\scriptstyle M^-$};
            \filldraw[color=black,       fill=gray]                    ( 0.00,  0.00) circle (1pt);
        \end{tikzpicture}
        \caption{Symmetric \\ imbalanced \\ single-opponent \\ receptive field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            \filldraw[color=greensea,    fill=turquoise!80, very thick]( 0.00,  0.00) circle (1.00);
            \filldraw[color=alizarin!90, fill=alizarin!70,  very thick]( 0.00,  0.00) circle (0.70)
                 node[color=black,       anchor=south] {$\scriptstyle L^+$}
                 node[color=black,       anchor=north] {$\scriptstyle M^-$};
            \filldraw[color=black,       fill=gray]                    ( 0.00,  0.00) circle (1pt);
        \end{tikzpicture}
        \caption{Classic \\ center/surround \\ single-opponent \\ receptive field}
    \end{subfigure}%
    \caption{Examples of various possible single-opponent receptive field configurations, many others could be designed. All function to describe color properties of surfaces, though their response patterns to similar stimuli vary slightly.}
\end{figure}


As mentioned, one of the three axes of the opponent process theory is lightness vs darkness. This is achieved by single-opponent cells by balancing the inputs into the \textit{on} center and the \textit{off} surround. By including equal input of L, M, and S cones into the center and surround, the cells becomes 'color blind' and instead only responds to changes in luminosity. Sometimes incorrectly labeled as non-opponent cells, these neurons are, indeed, single-opponent cells.

\textbf{//TODO} \textit{add image depicting example receptive field(s)}

\textbf{//TODO} \textit{add image of simple behavior: gradient response to ((mono)chromatic) intensity changes}

\textbf{//TODO} \textit{add image of simple behavior: no response to isoluminant chromatic boundaries}


\subsection*{Double-Opponent Neurons}

\textbf{Point:}
Double-opponent neurons are edge detectors. 

\textbf{Story:}
Double-opponent neurons are a topic of confusion in the field of neurobiology. All researchers on the topic seem to agree that the input to the neuron is that of two single-opponent neurons itself. In this sense, the term "double-opponent" can be thought of as indicating that the dimensionality of color opponency has been doubled. However, another camp of researchers take the definition a step further and suggest that the two SO inputs are spatially offset. By this definition, the term "double-opponent" is thought to indicate that the cell is sensitive to opponency in two \textit{different} dimensions, color and space.

The distinction is non-trivial as the response patterns differ, and thus the interpretation of their role in vision differs. Truly, both types of cells may, and likely do [\textbf{//TODO} \textit{Cite studies which find these cells}], exist in the primate visual system. However, for the purpose of our work we only consider the latter definition; double-opponent cells' receptive fields are both chromatically and spatially antagonistic.

\textbf{//TODO} \textbf{present the differences between the two DO configurations}

% FIGURE: Double-opponent receptive field schematics
\begin{figure}[H] \label{fig:do-rf-schematic}
    \centering
    \captionsetup{justification=centering}
    % 3 SUBFIGURES: Cross sections of double-opponent receptive fields
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-2.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-2.00);
            \draw[color=greensea,       very thick] (-1.05,-2.00) .. controls (-1.00,-2.10) .. (-0.95,-2.00);
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-2.00)
                 node[color=black, anchor=north west] {$M^-$};
            % ON Center
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 2.00);
            \draw[color=greensea,       very thick] ( 1.05, 2.00) .. controls ( 1.00, 2.10) .. ( 0.95, 2.00);
            \draw[color=greensea,       very thick] ( 2.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 2.00)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-2.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-1.00);
            \draw[color=greensea,       very thick] (-1.05,-1.00) .. controls (-1.00,-1.10) .. (-0.95,-1.00);
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-1.00)
                 node[color=black, anchor=north west] {$M^-$};
            % ON Center
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 1.00);
            \draw[color=greensea,       very thick] ( 1.05, 1.00) .. controls ( 1.00, 1.10) .. ( 0.95, 1.00);
            \draw[color=greensea,       very thick] ( 2.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 1.00)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=pomegranate!80, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[color=pomegranate!80, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[color=greensea,       very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[color=greensea,       very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$M^-$};
            % ON Center
            \draw[color=greensea,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[color=greensea,       very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[color=greensea,       very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[color=pomegranate!80, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[color=pomegranate!80, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[color=white]                                                (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}}
    \end{subfigure}%
    \par \bigskip
    % 3 SUBFIGURES: Top-down view of double-opponent receptive fields
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            \filldraw[color=pomegranate!80,       fill=turquoise!80, very thick]( 0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle M^+L^-$};
            \filldraw[color=greensea, fill=alizarin!80,  very thick](-0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle L^+M^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \end{tikzpicture}
        \caption{Symmetric \\ balanced \\ double-opponent \\ receptive field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            \filldraw[color=pomegranate!80,       fill=turquoise!80, very thick]( 0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle M^+L^-$};
            \filldraw[color=greensea, fill=alizarin!80,  very thick](-0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle L^+M^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \end{tikzpicture}
        \caption{Symmetric \\ imbalanced \\ double-opponent \\ receptive field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \begin{tikzpicture}
            % Frame to ensure alignment:
            \draw[color=white]                                            (-2.00, 0.00) --        (2.00, 0.00);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick](-0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle M^+L^-$};
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick](-0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=-90] {$\scriptstyle L^+M^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \end{tikzpicture}
        \caption{Center/ \\ surround \\ double-opponent \\ receptive field}
    \end{subfigure}%
    \caption{Examples of various possible double-opponent receptive field configurations, many others could be designed. All function to describe color properties of borders, though their response patterns to similar stimuli vary slightly.}
\end{figure}


\subsubsection*{Orientation Selectivity}

Research shows that cells identified as double-opponent are orientation selective. That is, they respond most strongly when stimulated by a border of particular orientation, less so with variation from that preferred orientation, and weekly, if at all, to borders orthogonal to the preferred orientation. This is intuitive given the organization of the receptive field as previously defined. By arranging the components of the receptive field to be spatially antagonistic, there will be one orientation of border which best separates the two components, and another orientation, precisely orthogonal, which does not separate the two components at all. This can be easily visualized, as in Figure \ref{fig:do-orient-h} and Figure \ref{fig:do-orient-v}.

\textbf{//TODO} \textit{add image of simple behavior: peak activity AT sharp edge}

It's worth noting that a single-opponent neuron can also be selective to specific orientations. These cells have been identified in biology, though their relative abundance appears minimal. To achieve orientation selectivity, the center and/or surround receptive fields simply need be made non-circular. However, without the balanced asymmetric \textit{on} and \textit{off} receptive fields from each opponent cone(s), an orientation specific single-opponent cell could never be as selective as a double-opponent cell.

% FIGURE: horizontal red/green double-opponent cell on horizontal red/green border
\begin{figure}[H] \label{fig:do-orient-h}
    \centering
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 1.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00, 0.58) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 1.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00, 0.65) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Maximum Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00,-0.58) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-1.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00,-0.65) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-1.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00,-1.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 1.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00, 0.58) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 1.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00, 0.65) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{No Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00,-0.58) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-1.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00,-0.65) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-1.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00,-1.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}
    \caption{A double opponent cell selective to horizontally oriented borders with red above and green below; only responsive to that particular stimulus. In Figure (b), the neuron is presented with its ideal stimulus: its $L^+$ and $M^+$ receptive fields are fully activated while its $L^-$ and $M^-$ receptive fields are completely unactivated. Figure (e) presents the neuron with the exact opposite stimulus, neither its $L^+$ nor $M^+$ receptive fields are activate at all, and both its $L^-$ and $M^-$ receptive fields are fully activated, ensuring no response possible from the cell. While its $L^+$ receptive field might be strongly stimulated in (a) and (f), it's $L^-$ receptive field cancels it out. Similarly, in (c) and (d) its $M^+$ receptive field is stimulated but cancelled out by activity in its $M^-$ receptive field.}
\end{figure}

% FIGURE: vertical red/green double-opponent cell on horizontal red/green border
\begin{figure}[H] \label{fig:do-orient-v}
    \centering
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43, 1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43, 1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35, 1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35, 1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
            \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
            \end{tikzpicture}
        \caption{Minimal Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
            \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43,-1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43,-1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35,-1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35,-1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00,-1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
            \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43, 1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43, 1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35, 1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35, 1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
            \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43, 0.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35, 0.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
            \end{tikzpicture}
        \caption{Minimal Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
            \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50, 0.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.43,-1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick](-0.43,-1.00) ellipse   (0.38 and 0.90);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.35,-1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick](-0.35,-1.00) ellipse   (0.30 and 0.90)
                 node[color=black, anchor=center, rotate=90] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00,-1.00) circle    (2pt);
            \draw (current bounding box.north east) rectangle (current bounding box.south west);
            \end{tikzpicture}
        \caption{Minor Response}
    \end{subfigure}
    \caption{A double opponent cell selective to vertically oriented borders with red to the right and green on the left; completely unresponsive to a horizontal border. While its $L^+$ receptive field might be strongly stimulated in (a) and (f), it's $L^-$ receptive field cancels it out. Similarly, in (c) and (d) its $M^+$ receptive field is stimulated but cancelled out by activity in its $M^-$ receptive field. In (b) and (e) both of its $L^+$ and $M^+$ receptive fields are moderately activated, but again, cancelled out by activation in its $L^-$ and $M^-$ receptive fields, respectively.}
\end{figure}


\subsubsection*{Spatial Frequency Selectivity}

% FIGURE: horizontal red/green double-opponent cell on horizontal red/green border of different spatial frequencies
\begin{figure}[H] \label{fig:do-orient-h}
    \centering
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 1.20);
            \fill[emerald!60]                                             (-1.50, 1.20) rectangle (1.50, 0.60);
            \fill[alizarin!60]                                            (-1.50, 0.60) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-0.60) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-1.20) rectangle (1.50,-0.60);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50,-1.20);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Maximum Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[emerald!60]                                             (-1.50, 2.00) rectangle (1.50, 1.00);
            \fill[alizarin!60]                                            (-1.50, 1.00) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-1.00) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-2.00) rectangle (1.50,-1.00);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Maximum Response}
    \end{subfigure}%
    \begin{subfigure}{0.2\textwidth}
        \centering
        \begin{tikzpicture}
            \fill[alizarin!60]                                            (-1.50, 2.00) rectangle (1.50, 1.80);
            \fill[emerald!60]                                             (-1.50, 1.80) rectangle (1.50, 1.50);
            \fill[alizarin!60]                                            (-1.50, 1.50) rectangle (1.50, 1.20);
            \fill[emerald!60]                                             (-1.50, 1.20) rectangle (1.50, 0.90);
            \fill[alizarin!60]                                            (-1.50, 0.90) rectangle (1.50, 0.60);
            \fill[emerald!60]                                             (-1.50, 0.60) rectangle (1.50, 0.30);
            \fill[alizarin!60]                                            (-1.50, 0.30) rectangle (1.50, 0.00);
            \fill[emerald!60]                                             (-1.50,-0.30) rectangle (1.50, 0.00);
            \fill[alizarin!60]                                            (-1.50,-0.60) rectangle (1.50,-0.30);
            \fill[emerald!60]                                             (-1.50,-0.90) rectangle (1.50,-0.60);
            \fill[alizarin!60]                                            (-1.50,-1.20) rectangle (1.50,-0.90);
            \fill[emerald!60]                                             (-1.50,-1.50) rectangle (1.50,-1.20);
            \fill[alizarin!60]                                            (-1.50,-1.80) rectangle (1.50,-1.50);
            \fill[emerald!60]                                             (-1.50,-2.00) rectangle (1.50,-1.80);
            \filldraw[color=greensea!80,    fill=turquoise!70, very thick]( 0.00, 0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=alizarin!90,    fill=alizarin!70,  very thick]( 0.00,-0.43) ellipse   (0.90 and 0.38);
            \filldraw[color=pomegranate!80, fill=alizarin!80,  very thick]( 0.00, 0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle L^+M^-$};
            \filldraw[color=greensea,       fill=turquoise!80, very thick]( 0.00,-0.35) ellipse   (0.90 and 0.30)
                 node[color=black, anchor=center] {$\scriptstyle M^+L^-$};
            \filldraw[color=black,          fill=gray]                    ( 0.00, 0.00) circle    (2pt);
        \draw (current bounding box.north east) rectangle (current bounding box.south west);
        \end{tikzpicture}
        \caption{Maximum Response}
    \end{subfigure}%
    \caption{A double opponent cell tuned to a particular spatial frequency. Either a (b) lower or a (c) higher spatial frequency than preferred lowers the response of the cell.}
\end{figure}

Another important feature of double-opponent cells is that they are inherently sensitive to borders of specific size, or scale. Technically, we refer to such preference of 'scale' as a cell's spatial frequency selectivity. Each double-opponent neuron will be selective to a particular spatial frequency and excited less so by stimuli of spatial frequency deviating from this preference. Again, this is quite intuitively a product of the design of the neuron's receptive field and easily visualized, as in Figure \ref{fig:do-scale}.

\textbf{//TODO} \textit{CONTRAST WITH SINGLE-OPPONENT'S LACK OF SPATIAL FREQ. SELECTIVITY (show Shapley's graphs) [erm.. don't we have spatial frequency for SO??]}


\subsubsection*{Achromatic Double-Opponent Neurons}

As we saw with single-opponent cells, while we frequently discuss opponency as being a thing of 'color', one of the axes of the opponent process theory is 'lightness' vs 'darkness'. This is easily achieved by balancing cone inputs into the neuron's antagonistic receptive fields. Such a cell is often referred to as an \textit{achromatic double-opponent} cell. It behaves just as the previously described double-opponent cells, with specific orientation and spatial frequency selectivity, but responds to luminosity borders rather than chromatic borders. For more details on achromatic receptive fields, please refer back to the section on \textit{Achromatic Single-Opponent Neurons}.

\textbf{//TODO} \textit{add image of Shapley response curves for SO, \& DO}

\subsection*{Hypercolumns}

Thus far we have defined two broad classes of neurons in the primate visual system: single-opponent and double-opponent. Each class has a number of parameters which dictate what stimuli the cell should respond to: opponent color, orientation selectivity, and spatial frequency. A single cell can only be sensitive to a specific combination of settings for each parameter. However, for each parameter it is important to have neurons sensitive to the full range of parameters. Thus, it is necessary to have a collection of neurons which together cover the complete combinatorial set of settings for all parameters.

Furthermore, as may be obvious, the receptive field of a neuron in V1 is directly \textbf{connected/related/tied \textit{(???)}} to a set of neurons in the retina. That is, neurons in V1 are sensitive only to activity at a particular physical location on the retina; V1 is \textit{retinotopic}, or retinally mapped.

The implication is that for each retinal position, in V1 it is necessary to have a large number of both single-opponent and double-opponent cells, selective to the full gamut of parameters possible for each type of cell. Biologically, these collections of cells are organized in \textit{hypercolumns}, a physical grouping of cells in which neuronal connections 'up' and 'down' within the column are much more dense than extensions to cells in other columns. Within a single hypercolumn, all cells are sensitive to a specific retinal location, but together express sensitivity to the full range of parameters.

\textbf{//TODO} \textit{mention relative abundance of SO, \& DO}


\subsection*{CO Blobs}

\textbf{//TODO} \textit{PARAGRAPH ON WHERE DO CELLS ARE}

\textbf{//TODO} \textit{PARAGRAPH ON WHERE SO CELLS ARE}

\textbf{//TODO} \textit{PARAGRAPH ON PROPOSED CONNECTIONS BETWEEN DO \& SO}


\subsection{Computational Modeling:}

The model described in this research is an extension of that presented by Penacchio \textit{et al.} \cite{otazu:plosive}, itself based on work by Z. Li \cite{li:1998, li:1999}. Before detailing our implementation, it is important to review prior art, these works and others. As our goal is to model the behavior of color preferring and achromatic single-opponent and double-opponent neurons, we will also review other computational endeavors tackling the issue of color and/or form from a biologically inspired perspective.


\subsection*{Li's Neurodynamical Model for Segmentation (1999)}
In Li's original work, a neurodynamical model was presented which focused on the global region segmentation using only local interactions between neurons. In the interest of simplicity, Li's implementation dealt only with the nature of these interactions, ignoring where the stimulus, or information, might be coming from. Conceptually, Li defined neurons by the physical position in the image and the 'feature' to which they are sensitive. She then defined the connections between these neurons such that those physically close to each other, and sensitive to similar features, interacted most strongly. Stimulation of one neuron, then, positively stimulated (excited) similar neurons nearby, and negatively stimulated (inhibited) dissimilar neurons nearby. Such excitation and inhibition cascades through the network naturally, producing a large scale response pattern defined by local stimuli.

In the model presented, Li used oriented bars as features, though expressed that any logical feature could be reasonably considered in its place. This choice was biologically inspired by neurons sensitive to specifically oriented bars, the aforementioned double-opponent cells. When considering such features, inter-neuronal connections can be logically deduced: two neurons positively interact most when both 1) are sensitive to similarly oriented bars and 2) are co-located along that same orientation. Two neurons negatively interact most when either of these two conditions is not met.

\textbf{//TODO} \textit{include graphic or oriented bars which positively \& negatively interact}

By defining the neuronal connectivity in this manner, patterns of neurons sensitive to co-located and co-aligned bars positively interact with each other to enhance their collective response to the stimuli. Similarly, isolated stimuli negatively interact with their neighbors and are silenced. From these local interactions, global features are enhanced if they satisfy the neuronal connectivity rules, and noise is suppressed. Li showed that this method can be used to enhance contours and identify boundaries between regions for which normal segmentation methods struggle.

\subsection*{Penacchio, Otazu, \& Dempere-Marco's Neurodynamical Model for Brightness Induction (2013)}
Li's work laid the foundation for Penacchio \textit{et al.} who extended the model to a usable framework which:
\begin{enumerate}
    \item Uses real black \& white images /movies as input.
    \item Utilizes discrete wavelet transforms to extract edges (more on this later).
    \item Added multi scale support.
    \item Summarizes the results into an output 'perceptual image'.
\end{enumerate}
Their research was focused on observing brightness induction (BI) arising from such a neurodynamical model.
\begin{itemize}
    \item No color, just black \& white \textit{edges}
    \item Generalized to real images (edges vs lines)
    \item Added scales
    \item Dynamical processing
    \item \textbf{Avoid detail, save that for \textit{Method}..?}
    \item Extension of Z. Li's edge detection work
    \item Uses DWT to extract oriented edges in grayscale
    \begin{itemize}
        \item ..in our context, it's essentially a luminance sensitive double-opponent cell.
    \end{itemize}
\end{itemize}


\subsection*{Itti, Koch, \& Niebur's Model for Saliency (1999)}
\begin{itemize}
    \item Opponent color transformations
    \item No double-opponent cells
    \item Center \& surround using scales
    \item Has scales, but collapses them into one (right?)
    \item \textit{No dynamical processing}
\end{itemize}


\subsection*{Zhang, Barhomi, \& Serre's Biologically Inspired Color Descriptor (2013)}
\begin{itemize}
    \item Single \& double-opponent color using weights
    \item Has center/surround (Gabor filters for DO, gaussians for SO?)
    \item No scales
    \item \textit{No dynamical processing}
\end{itemize}


\subsection*{Spitzer \& Barkan's Model of Color Induction (2005)}
\begin{itemize}
    \item Single \& double-opponent color transformations using receptive fields
    \item Center \& surround receptive fields
    \item \textit{No dynamical processing}
\end{itemize}

\subsection*{Comparison of Models}
Our current work is a direct continuation of the research presented in the first two of these computational models. The latter three represent but a small selection of the wealth of effort being put into computationally describing color in a biologically plausible manner. It is important to recognize that these five models each had different specific research goals and so do not intend to be directly compared to one another. We present them here to frame our current work. Table \ref{tab:model-comparison} presents the features implemented in these models with respect to the goals of our work. This comparison elucidates our intentions: to bring biologically inspired descriptions of color to the neurodynamical processing model developed by Penacchio \cite{penacchio:2013} and Li \cite{li:1999}.

\begin{table}[H] \label{tab:model-comparison}
    \centering
    \caption{Comparison of computational models relevant to our current work.}
    \begin{threeparttable}
    \begin{tabular}{rcccccc}
        \multicolumn{1}{r|}{}             & Proposed Model   & Penacchio \cite{penacchio:2013} & Li \cite{li:1999} & Itti \cite{itti:1998} & Zhang \cite{zhang:2012} & Spitzer \cite{spitzer:2005} \\ \cline{1-7}
        \multicolumn{1}{r|}{Dynamical}    & Y                & Y                               & Y                 & N                     & N                       & N               \\
        \multicolumn{1}{r|}{Colors}       & Y                & N                               & N                 & Y                     & Y                       & Y               \\
        \multicolumn{1}{r|}{Scales}       & Y                & Y                               & N                 & Y                     & N                       & N               \\
        \multicolumn{1}{r|}{Orientations} & Y                & Y                               & Y                 & Y                     & N                       & N               \\
        \multicolumn{1}{r|}{SO}           & Y                & N                               & N                 & Y                     & Y                       & Y               \\
        \multicolumn{1}{r|}{DO}           & Y                & Y \textit{(achromatic)}         & N                 & Y                     & Y                       & Y               \\
        \multicolumn{1}{r|}{SO RF}        & Gaussian / DWT   & N/A                             & N/A               & Gaussian Pyramid      & None                    & Gaussian        \\
        \multicolumn{1}{r|}{DO RF}        & Gabor-like / DWT & DWT                             & N/A               & Gaussian Pyramid      & None                    & Gabor           \\
        \multicolumn{1}{r|}{Goal}         & Color Induction  & Brightness Induction            & Saliency          & Saliency              & Color Descriptor        & Color Induction
    \end{tabular}
    \begin{tablenotes}
        \item In the interest of clarity, the categories are defined below.
        \begin{tabular}{p{1.5cm} r l}
            & Dynamical:    & Does the work attempt to model neurodynamical processes? \\
            & Colors:       & Does the work consider chromatic differences as features? \\
            & Scales:       & Does the work separate information at different scales? \\
            & Orientations: & If incorporating edge/boundary features, does the work distinguish between orientations? \\
            & SO:           & Does the work attempt to model single-opponent cell behavior, directly or indirectly? \\
            & DO:           & Does the work attempt to model double-opponent cell behavior, directly or indirectly? \\
            & SO RF:        & If modeling single-opponent cells, how are their receptive fields defined? \\
            & DO RF:        & If modeling double-opponent cells, how are their receptive fields defined? \\
            & Goal:         & Generally speaking, what was the purpose of the modeling effort?
        \end{tabular}
    \end{tablenotes}
    \end{threeparttable}
\end{table}


\subsection{State of the Art Summary}

\textbf{//TODO} \textit{We need to properly summarize the State of the Art before proceeding.}
\begin{itemize}
    \item bleh
    \begin{itemize}
        \item What does the biology predict?
        \item What have computational models done?
        \item Where do computational models fall short? (A: no dynamical color model)
        \item Thus, where does our work fit into the field?
    \end{itemize}
    \item To recapitulate: single-opponent neurons fire best to full field stimulation while double-opponent neurons fire only at the boundaries between particular colors. Both cell types can be found in color preferring and achromatic flavors.
    \item \textbf{//TODO} This understanding treats color and shape as intrinsically connected and, as a consequence, predicts perceptual phenomena such as color induction to arise very early in visual processing.
    \item The purpose of this project is to \textbf{feed opponent color information into a neurodynamical model} sensitive to edges \& surfaces in a biologically inspired manner.
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% METHOD
%
% Here we detail the computational approach used to solve the
% problem.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Method}

We present a computational model designed to be representative of the aforementioned biology. The implementation of this model can be conceived of as two distinct parts:
\begin{itemize}
    \item \textit{Description of Visual Information:} transformation of image(s) into a biologically meaningful representation.
    \item \textit{Neurodynamical Processing:} iterative processing of the dynamic interactions between the neurons modeled.
\end{itemize}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{model1_mockup}
    \caption{High level schematic of model components. The point of emphasis here is that neurodynamical model is agnostic to how the data is processed upfront, as long as the format is correct. The two methods for data preparation (read: color description) are independent of each other and analyzed separately.}
    \label{fig:model-parts}
\end{figure}

\subsection*{Description of Visual Information}

The opponent-process theory defines three axes visual information, obtained by processing of cone activity from the retina. These axes are Red-Green (R-G), Blue-Yellow (B-Y), and Light-Dark (L-D). Neurobiological research corroborates such processing of color information (\textbf{//TODO} \textit{cite this}). \textbf{//TODO} \textit{MORE ON OPPONENT-PROCESS THEORY}

\textbf{//TODO} \textit{PARAGRAPH ON SINGLE AND DOUBLE OPPONENT CELLS}

In accordance with this understanding of biology, the image transformation process should 1) separate opponent color components from each other, and 2) separate surface information from boundary information. We describe two different approaches to this end. The first approach, herein referred to in prolixity as the "\textit{Opponent Processing of Neural Receptive Fields}", represents an effort to explicitly transform raw visual data in strict accordance with neurobiology. Essentially attempting to mimic the information processing pathways of the retina, lateral geniculate nucleus (LGN), and striate cortex (V1). The second approach, termed with equal verbosity, is the \textit{"Discrete Wavelet Transform in Opponent Colorspace"}. Here we stray from the details of the biological pathways in an attempt to achieve the same end, through more computationally efficient means.

In both, the input is a normal RGB image, and the output to the neurodynamical model is a 5 dimensional matrix containing 6 opponent color channels (R, G, B, Y, L, \& D), each deconvoluted into its surface and oriented edge components, and 1 or more scales. In this work we generalize oriented edges into 3 orientations: horizontal, diagonal, \& vertical. Before processing by the neurodynamical model, this data is normalized so as to circumvent differences between the data output by these two methods.

\subsection{Opponent Processing of Neural Receptive Fields}

% FIGURE: Opponent Processing Diagram
\begin{figure}[h] \label{fig:opp-workflow}
    \centering
    \captionsetup{justification=centering}
    \resizebox{\textwidth}{!}{%
    \begin{tikzpicture}[auto, >=latex']
    % RGB Input
    \draw ( -4.0,  25) node(r)[draw, shape=rectangle, minimum height=1.5cm, minimum width=2cm, align=center] {L};
    \draw (  0.0,  25) node(g)[draw, shape=rectangle, minimum height=1.5cm, minimum width=2cm, align=center] {M};
    \draw (  4.0,  25) node(b)[draw, shape=rectangle, minimum height=1.5cm, minimum width=2cm, align=center] {S};
    % Gaussian Convolutions
    \draw ( -3.0,  18) node(c)[draw, shape=circle, minimum height=5cm, minimum width=5cm, align=center] {};
    \draw (  3.0,  18) node(s)[draw, shape=circle, minimum height=5cm, minimum width=5cm, align=center] {};
    \node at (c.north) [below=0.4cm] {CENTER};
    \node at (c.north) [below=0.9cm] {Convolution};
    \node at (s.north) [below=0.4cm] {SURROUND};
    \node at (s.north) [below=0.9cm] {Convolution};
    % RGB Centers & Surrounds
    \draw ( -9.0,   8) node(rc)[draw, shape=rectangle, minimum height=1cm, align=center] {L Center};
    \draw ( -6.0,  10) node(gc)[draw, shape=rectangle, minimum height=1cm, align=center] {M Center};
    \draw ( -3.0,  12) node(bc)[draw, shape=rectangle, minimum height=1cm, align=center] {S Center};
    \draw (  3.0,  12) node(rs)[draw, shape=rectangle, minimum height=1cm, align=center] {L Surround};
    \draw (  6.0,  10) node(gs)[draw, shape=rectangle, minimum height=1cm, align=center] {M Surround};
    \draw (  9.0,   8) node(bs)[draw, shape=rectangle, minimum height=1cm, align=center] {S Surround};
    % Colors
    \draw (-16.25,  0) node(L)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Light};
    \draw ( -9.75,  0) node(D)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Dark};
    \draw ( -3.25,  0) node(R)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Red};
    \draw (  3.25,  0) node(G)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Green};
    \draw (  9.75,  0) node(B)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Blue};
    \draw ( 16.25,  0) node(Y)[draw, shape=rectangle, minimum height=1cm, minimum width=2cm, align=center] {Yellow};
    \node (Lon)  at (L.north) [above left]  {+};
    \node (Don)  at (D.north) [above left]  {+};
    \node (Ron)  at (R.north) [above left]  {+};
    \node (Gon)  at (G.north) [above left]  {+};
    \node (Bon)  at (B.north) [above left]  {+};
    \node (Yon)  at (Y.north) [above left]  {+};
    \node (Loff) at (L.north) [above right] {-};
    \node (Doff) at (D.north) [above right] {-};
    \node (Roff) at (R.north) [above right] {-};
    \node (Goff) at (G.north) [above right] {-};
    \node (Boff) at (B.north) [above right] {-};
    \node (Yoff) at (Y.north) [above right] {-};
    % Paths A
    \draw [->, pomegranate] (r)  to[bend right] (c);
    \draw [->, greensea]    (g)  to             (c);
    \draw [->, peter]       (b)  to             (c);
    \draw [->, pomegranate] (r)  to             (s);
    \draw [->, greensea]    (g)  to             (s);
    \draw [->, peter]       (b)  to[bend left]  (s);
    % Paths B
    \draw [->, pomegranate] (c)  to[bend right] (rc);
    \draw [->, greensea]    (c)  to             (gc);
    \draw [->, peter]       (c)  to             (bc);
    \draw [->, pomegranate] (s)  to             (rs);
    \draw [->, greensea]    (s)  to             (gs);
    \draw [->, peter]       (s)  to[bend left]  (bs);
    % Paths C
    \draw [->, pomegranate] (rc) to             (Lon);
    \draw [->, greensea]    (gc) to[bend right] (Lon);
    \draw [->, pomegranate] (rs) to             (Loff);
    \draw [->, greensea]    (gs) to             (Loff);
    \draw [->, pomegranate] (rs) to[bend right] (Don);
    \draw [->, greensea]    (gs) to[bend right] (Don);
    \draw [->, pomegranate] (rc) to[bend left]  (Doff);
    \draw [->, greensea]    (gc) to[bend left]  (Doff);
    \draw [->, pomegranate] (rc) to             (Ron);
    \draw [->, greensea]    (gs) to             (Roff);
    \draw [->, greensea]    (gc) to             (Gon);
    \draw [->, pomegranate] (rs) to             (Goff);
    \draw [->, peter]       (bc) to             (Bon);
    \draw [->, greensea]    (gs) to             (Boff);
    \draw [->, pomegranate] (rs) to             (Boff);
    \draw [->, greensea]    (gc) to             (Yon);
    \draw [->, pomegranate] (rc) to             (Yon);
    \draw [->, peter]       (bs) to[bend left]  (Yoff);
    % Example Gaussian Convolutions
    \node[below of=c] {
        \begin{tikzpicture}
            % ON Center
            \draw[gray, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[gray, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[gray, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00);
            % Reference line & point
            \draw                                                              (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                  ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                   (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \node[below of=s] {
        \begin{tikzpicture}
            % OFF Surround
            \draw[gray, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[gray, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[gray, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48);
            % Reference line & point
            \draw                                                              (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                  ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                   (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    % Example Single Opponent Receptive Fields
    \node[below of=L, node distance=1.5in] (Lso) {
        \begin{tikzpicture}
            % ON Center
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \node[below of=D, node distance=1.5in] (Dso) {
        \begin{tikzpicture}
            \begin{scope}[rotate=180]
            % OFF Center
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % ON Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
            \end{scope}
        \end{tikzpicture}
    };
    \node[below of=R, node distance=1.5in] (Rso) {
        \begin{tikzpicture}
            % ON Center
            \draw[pomegranate!80, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[pomegranate!80, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[pomegranate!80, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[greensea,       very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[greensea,       very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[greensea,       very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \node[below of=G, node distance=1.5in] (Gso) {
        \begin{tikzpicture}
            % ON Center
            \draw[greensea,       very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[greensea,       very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[greensea,       very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[pomegranate!80, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[pomegranate!80, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[pomegranate!80, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$L^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \node[below of=B, node distance=1.5in] (Bso) {
        \begin{tikzpicture}
            % ON Center
            \draw[peter,          very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[peter,          very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[peter,          very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$S^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \node[below of=Y, node distance=1.5in] (Yso) {
        \begin{tikzpicture}
            % ON Center
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-1.00, 0.00) .. controls (-0.30, 0.05) .. (-0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] (-0.05, 2.00) .. controls ( 0.00, 2.10) .. ( 0.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, very thick] ( 1.00, 0.00) .. controls ( 0.30, 0.05) .. ( 0.05, 2.00)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[peter,          very thick] (-1.50, 0.00) .. controls (-0.30,-0.20) .. (-0.05,-0.48);
            \draw[peter,          very thick] (-0.05,-0.48) .. controls ( 0.00,-0.49) .. ( 0.05,-0.48);
            \draw[peter,          very thick] ( 1.50, 0.00) .. controls ( 0.30,-0.20) .. ( 0.05,-0.48)
                 node[color=black, anchor=north west] {$S^-$};
            % Reference line & point
            \draw                                                             (-1.50, 0.00) -- ( 1.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    };
    \end{tikzpicture}
    }
    \caption{Diagram of \textit{Opponent Processing of Receptive Fields} workflow. The L, M, and S channels are convoluted with center and surround gaussians and then combined to build opponent colors, here exemplified by single-opponent cell receptive fields. The process is similar for double-opponent cells.}
\end{figure}

% FIGURE: Colored Double Opponent Receptive Fields
\begin{figure}
    \centering
    \captionsetup{justification=centering}
    % 3 SUBFIGURES: Cross sections of single-opponent receptive fields
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Light DO \\ Receptive Field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Dark DO \\ Receptive Field}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[pomegranate!80, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[pomegranate!80, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[pomegranate!80, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[greensea,       very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[greensea,       very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[greensea,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$M^-$};
            % ON Center
            \draw[greensea,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[greensea,       very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[greensea,       very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[pomegranate!80, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[pomegranate!80, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[pomegranate!80, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Red DO \\ Receptive Field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[greensea, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[greensea, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[greensea, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$M^+$};
            % OFF Surround
            \draw[pomegranate!80,       very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[pomegranate!80,       very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[pomegranate!80,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$L^-$};
            % ON Center
            \draw[pomegranate!80,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[pomegranate!80,       very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[pomegranate!80,       very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$L^+$};
            % OFF Surround
            \draw[greensea, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[greensea, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[greensea, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$M^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Green DO \\ Receptive Field}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[color=peter!80, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[color=peter!80, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[color=peter!80, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$S^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[color=peter!80, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[color=peter!80, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[color=peter!80, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$S^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Blue DO \\ Receptive Field}
    \end{subfigure}%
    \begin{subfigure}{0.3\textwidth}
        \centering
        \resizebox{\textwidth}{!}{%
        \begin{tikzpicture}
            % ON Center
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-2.00, 0.00) .. controls (-1.30, 0.05) .. (-1.05, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 (-1.05, 2.00) .. controls (-1.00, 2.10) .. (-0.95, 2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls (-0.70, 0.05) .. (-0.95, 2.00)
                 node[color=black, anchor=south west] {$L^+M^+$};
            % OFF Surround
            \draw[color=peter,       very thick] (-3.00, 0.00) .. controls (-1.30,-0.05) .. (-1.05,-0.48);
            \draw[color=peter,       very thick] (-1.05,-0.48) .. controls (-1.00,-0.49) .. (-0.95,-0.48);
            \draw[color=peter,       very thick] ( 0.00, 0.00) .. controls (-0.70,-0.05) .. (-0.95,-0.48)
                 node[color=black, anchor=north west] {$S^-$};
            % ON Center
            \draw[color=peter,       very thick] ( 0.00, 0.00) .. controls ( 0.70, 0.05) .. ( 0.95, 0.48);
            \draw[color=peter,       very thick] ( 1.05, 0.48) .. controls ( 1.00, 0.49) .. ( 0.95, 0.48);
            \draw[color=peter,       very thick] ( 3.00, 0.00) .. controls ( 1.30, 0.05) .. ( 1.05, 0.48)
                 node[color=black, anchor=south west] {$S^+$};
            % OFF Surround
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[pomegranate!80, dash pattern= on 3pt off 5pt, dash phase=4pt, very thick] ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 0.00, 0.00) .. controls ( 0.70,-0.05) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 1.05,-2.00) .. controls ( 1.00,-2.10) .. ( 0.95,-2.00);
            \draw[greensea,       dash pattern= on 3pt off 5pt, very thick]                 ( 2.00, 0.00) .. controls ( 1.30,-0.05) .. ( 1.05,-2.00)
                 node[color=black, anchor=north west] {$L^-M^-$};
            % Reference line & point
            \draw                                                             (-2.50, 0.00) -- ( 2.50, 0.00);
            \filldraw[color=black, fill=gray]                                 ( 0.00, 0.00) circle (2pt);
            % Frame to ensure alignment:
            \draw[opacity=0]                                                  (-3.00, 2.50) rectangle (3.00, -2.50);
        \end{tikzpicture}
    }
    \caption{Yellow DO \\ Receptive Field}
    \end{subfigure}%
\end{figure}

\subsubsection*{Neural Receptive Fields}

\textbf{//TODO} \textit{REFACTOR INTO PARAGRAPH ON RECEPTIVE FIELDS}

\subsubsection*{Opponent Processing}

\textbf{//TODO} \textit{REFACTOR INTO PARAGRAPH ON OPPONENT PROCESSING}

Processing starts by convoluting each of the L, M, and S cone spectral response functions with two different gaussian filters. These convolutions simulate integration of information in a neuron's receptive field. One convolution is used to build the excitatory component of the receptive field (referred to as the center), the other convolution, the inhibitory (referred to as the surround).

Single-opponent cells' receptive fields are the classical center-surround configuration: symmetric, centered, circular gaussians. Typically, the center is smaller and weighed significantly more heavily than the surround, as in Figure \ref{fig:rd-so} (c). Double-opponent receptive fields are markedly more complex: asymmetrical, off-center, elongated gaussian filters. Similarly, these filters can be adjusted to different sizes, shapes, and weights. For our tests we worked with symmetric balanced receptive fields, as in Figure \ref{fig:rd-do} (a).

In our implementation, for convenience, we utilize the R, G, and B channels of the raw image as an approximation of L, M, and S cone activity, respectively. It should be noted that a preprocessing step could be performed to better match RGB to LMS so as to be more biologically consistent. The impact is likely negligible.

To construct opponent color channels, we contrast center $(c)$ and surround $(s)$ convolutions of the L, M, and S channels into three pairs: two color \cite{spitzer:2005} and one achromatic.

\begin{flalign}
    R(c, s, \sigma) &= max(0, L(c, \sigma) - M(s, \sigma)) \\
    G(c, s, \sigma) &= max(0, M(c, \sigma) - L(s, \sigma)) \\
    B(c, s, \sigma) &= max(0, S(c, \sigma) - \frac{L(s, \sigma) + M(s, \sigma)}{2}) \\
    Y(c, s, \sigma) &= max(0, \frac{L(c, \sigma) + M(c, \sigma)}{2} - S(s, \sigma))
\end{flalign}

We also introduce two new opponent channels, lightness (L) and darkness (D):

\begin{flalign}
    L(c, s, \sigma) &= max(0, \frac{L(c, \sigma) + M(c, \sigma) + S(c, \sigma)}{3} - 0.5) \\
    D(c, s, \sigma) &= | min(0, \frac{L(c, \sigma) + M(c, \sigma) + S(c, \sigma)}{3} - 0.5) |
\end{flalign}

\textbf{//TODO} \textit{consider} $\frac{L(c) + M(c) + S(c)}{3} - \frac{L(s) + M(s) + S(s)}{3})$

\textbf{//TODO} \textit{consider} $(L(c) + M(c)) - (L(s) + M(s))$ \textit{(Rolf \& Deco)}

It is important to note that the L \& D opponent channels do not incorporate surround effects as the color opponent channels do. More work can be done in this regard.


\textbf{//TODO} \textit{ADD L \& D to Figure \ref{fig:opponent-process}}

\textbf{//TODO} \textit{PARAGRAPH ON DOUBLE-OPPONENT ORIENTATIONS}

\textbf{//TODO} \textit{PARAGRAPH ON SCALE}

\subsubsection{Considerations}
\begin{itemize}
    \item CON: Relatively slow
    \begin{itemize}
        \item Could be improved with Gabor instead of gaussian for DO cells.
        \item Could be improved by reusing SO info -> more biological
        \item It's just an upfront cost, the neurodynamical processing is the most expensive.
    \end{itemize}
    \item PRO: more receptive field control (explicit RF definitions)
    \item CON: requires tweaking of receptive fields
    \item PRO: more true to biology (combination of signal rather than numeric transformation of colorspace)
    \item CON: requires decision on meaningful RGB combination (should be elucidated from biology)
    \begin{itemize}
        \item Pre-transformation to LMS might be valuable/meaningful.
    \end{itemize}
\end{itemize}

\textbf{//TODO} \textit{show original \& decomposed image}


\subsection*{Summary}

This first of two approaches to color representation aims to be true to the biology at all cost. We explicitly model the receptive fields of both single-opponent and double-opponent neurons. These receptive fields are used to transduce retinal activity of L, M, and S cones into the cell activity expected in V1.


\subsection{Discrete Wavelet Transform in Opponent Colorspace}

Previous work by Penacchio \textit{et al.} \cite{otazu:plosive} utilized a discrete wavelet transform (DWT) to decompose a greyscale image into its oriented edge components, at scales. In the context of our current research, this could be thought of as representing achromatic double-opponent cells; the response is greatest at luminosity boundaries, and nonexistent on surfaces or at chromatic changes. In this work we extend their approach to the opponent colorspace and examine its applicability as a replacement of the previously detailed \textit{Opponent Processing of Neural Receptive Fields}.

\subsubsection*{Opponent Colorspace}
This transformation begins, not with the convolution step, but instead with a colorspace transformation. We convert the image from RGB to \textit{CIE} $L^*a^*b^*$. This colorspace separates luminance from it's two opponent color channels. The two color channels are $0$ centered, with both positive and negative values possible. The luminance channel, $L^*$, scales from $0$ to $100$, $0$ being total darkness, $100$ being pure brightness. We subtract $50$ from this channel to obtain a $0$ centered range of luminance. We consider positive values to define 'lightness' and negative values 'darkness'. From the opponent color channels, we take positive values in the $a^*$ channel as denoting 'redness' and negative values 'greenness', while positive values in the $b^*$ channel indicate 'blueness' and negative values 'yellowness'.

\subsubsection*{Discrete Wavelet Transform}
Similar to the aforementioned use of gaussian filters, the application of the DWT can be interpreted as representative of the processing in a cell's receptive field. That is, the activity of a particular cell is defined not just by its own activity, but also of the activity of the cells around it. The key difference here being that the DWT is applied \textit{in} the opponent colorspace, while in our previous approach the convolutions are applied to the raw L, M, and S input, before deriving opponent colors.

As all color channels are $0$ centered, we can easily split them into independent opponent components:
\begin{align}
    Li_{do} &=   max(0, DWT(L^*-50))              \\
    Li_{so} &=   max(0, DWT(L^*-50)_{residual})   \\
    Da_{do} &= | min(0, DWT(L^*-50)) |            \\
    Da_{so} &= | min(0, DWT(L^*-50)_{residual}) | \\
    R_{do}  &=   max(0, DWT(a^*))              \\
    R_{so}  &=   max(0, DWT(a^*)_{residual})   \\
    G_{do}  &= | min(0, DWT(a^*)) |            \\
    G_{so}  &= | min(0, DWT(a^*)_{residual}) | \\
    B_{do}  &=   max(0, DWT(b^*))              \\
    B_{so}  &=   max(0, DWT(b^*)_{residual})   \\
    Y_{do}  &= | min(0, DWT(b^*)) |            \\
    Y_{so}  &= | min(0, DWT(b^*)_{residual}) |
\end{align}

\textbf{//TODO} \textit{FIGURE: show diagram of oriented DWT filter (use TikZ)}

\textbf{//TODO} \textit{FIGURE: show original \& decomposed image}

\textbf{//TODO} \textit{PARAGRAPH ON INTERPRETATION OF COMPONENTS (DO \& SO)}

\textbf{//TODO} \textit{PARAGRAPH ON WORKFLOW: RGB $\rightarrow$ L*a*b* (-50) $\rightarrow$ DWT $\rightarrow$ ON/OFF}

\textbf{//TODO} \textit{PARAGRAPH ON PROS/CONS}


\subsection*{Neurodynamical Processing}

Stage I of the proposed method focuses on the description of color in a biologically meaningful form, of which we've described two distinct approaches. Stage II is to further process this data in an iterative computational model of neurodynamical processes, as defined in Equations \ref{eq:delta-x} and \ref{eq:delta-y}. The input stimulus, from Stage I, at time $\tau$, $I^\tau_{i\gamma\sigma\theta}$ drives the model and mainly determines its response. The normalization of the stimulus at each time step is extended from that proposed by Li \cite{li:1999} and Penacchio \cite{penacchio:2013}. We normalize within each color channel ($\gamma$), scale ($\sigma$), and orientation ($\theta$). At the first time step, $I^1_{i\gamma\sigma\theta}$ is used to bootstrap the model and set as the initial excitation response, $x_{i\gamma\sigma\theta}$.

$x_{i\gamma\sigma\theta}$ can be viewed as a model of retinotopic excitation hypercolumns in V1, with $i$ specifying the retinally mapped location of the hypercolumn. Similarly, $y_{i\gamma\sigma\theta}$ may be interpreted as its retinotopic inhibitory counterpart. $\dot{x}_{i\gamma\sigma\theta}$ and $\dot{y}_{i\gamma\sigma\theta}$, then, are the change in excitatory and inhibitory membrane potentials over time, respectively, and follow the equations:
\begin{align}
    \dot{x}_{i\gamma\sigma\theta} &= \begin{aligned}[t]
        & - \alpha_{x}x_{i\gamma\sigma\theta} \label{eq:delta-x} \\
        & - g_y(y_{i\gamma\sigma\theta}) \\
        & - \sum\nolimits_{\gamma' \neq \text{opp($\gamma$)},\Delta_{\sigma},\Delta_{\theta} \neq 0}
            \Psi(\gamma',\Delta_{\sigma},\Delta_{\theta})
            g_y(y_{i\gamma\sigma + \Delta_{\sigma\theta} + \Delta_{\theta}})
            + J_0g_x(x_{i\gamma\sigma\theta}) \\
        & + \sum\nolimits_{j \neq i,\gamma' \neq \text{opp($\gamma$)},\sigma'\theta'}
            J_{[i\gamma\sigma\theta, j\gamma'\sigma'\theta']}g_x(x_{j\gamma'\sigma'\theta'})) \\
        & + I^\tau_{i\gamma\sigma\theta} \\
        & + I_0
        \end{aligned} \\
    \dot{y}_{i\gamma\sigma\theta} &= \begin{aligned}[t]
        & - \alpha_{y}Y_{i\gamma\sigma\theta} \label{eq:delta-y} \\
        & + g_x(X_{i\gamma\sigma\theta}) \\
        & + \sum\nolimits_{j \neq i, \gamma'\sigma'\theta'}
            W_{[i\gamma\sigma\theta, j\gamma'\sigma'\theta']}g_x(x_{j\gamma'\sigma'\theta'}) \\
        & + I_{c}
       \end{aligned}
\end{align}
where $\alpha_{x}x_{i\gamma\sigma\theta}$ and $\alpha_{y}Y_{i\gamma\sigma\theta}$ model the decay to the resting potential, $g_x(x)$ and $g_y(y)$ are sigmoid-like functions modeling cells' firing rates in response to membrane potentials $x$ and $y$, respectively, $\Psi(\gamma',\Delta_{\sigma},\Delta_{\theta}) \leq 1$ is the spread of inhibition within a hypercolumn, $J_0g_x(x_{i\gamma\sigma\theta})$ is self-excitation, and $I_c$ is background noise \cite{li:1999}.
Any cell can interact with another by exciting it or inhibiting it, via monosynaptic excitation through excitatory-excitatory horizontal connections, or disynaptic inhibition through excitatory-inhibitory connections, respectively \cite{penacchio:2013}. Such interactions are modeled between cells within and across hypercolumns; color, scale, and orientation, as well as between cells within and across cell classes; double-opponent and single-opponent. These cellular interactions are defined by $J_{[i\gamma\sigma\theta, j\gamma'\sigma'\theta']}$ (excitatory) and $W_{[i\gamma\sigma\theta, j\gamma'\sigma'\theta']}$ (inhibitory). 

\subsubsection*{Orientation ($\theta$)}
The excitatory and inhibitory interactions between orientation specific double-opponent cells are exactly as those defined by Penacchio \cite{penacchio:2013} and Li \cite{li:1999}. Single-opponent cells, introduced in our work, are non-directional; they have no preferred orientation $\theta$. $\Delta\theta$ is thus not computable and so this class of cells do not \textit{inhibit} the activity of other cells. Single-opponent cells do not contribute to $W$. In order to explore 'fill in' effects, however, we support parameterization of \textit{excitatory} weights to and from single-opponent and double-opponent cells. This weight functions as $\Delta\theta$ and is equal for all preferred orientations of the double-opponent cells. These interactions are modeled by a circular-symmetric gaussian in $J$. 

% FIGURE: Bowtie Excitatory Interaction Maps
\begin{figure}[h] \label{fig:bowtie-excite-maps}
    \centering
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_1_1}
            \caption{\\ Verical DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_1_2}
            \caption{\\ Verical DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_blank}
            \caption{\\ Verical DO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_1_4}
            \caption{\\ Verical DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_2_1}
            \caption{\\ Diagonal DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_2_2}
            \caption{\\ Diagonal DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_2_3}
            \caption{\\ Diagonal DO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_2_4}
            \caption{\\ Diagonal DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_blank}
            \caption{\\ Horizontal DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_3_2}
            \caption{\\ Horizontal DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_3_3}
            \caption{\\ Horizontal DO \\ \& Horizontal DO}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_3_4}
            \caption{\\ Horizontal DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_4_1}
            \caption{\\ Non-Oriented SO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_4_2}
            \caption{\\ Non-Oriented SO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_4_3}
            \caption{\\ Non-Oriented SO \\ \& Horizontal DO}
    \end{subfigure}
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{j_4_4}
            \caption{\\ Non-Oriented SO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \caption{Graphical representation of \textit{excitatory} interaction weights ($J$) between vertical, diagonal, and horizontal double-opponent cells and single-opponent cells.}
\end{figure}

% FIGURE: Bowtie Inhibitory Interaction Maps
\begin{figure}[h] \label{fig:bowtie-excite-maps}
    \centering
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_1_1}
            \caption{\\ Verical DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_1_2}
            \caption{\\ Verical DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Verical DO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Verical DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_2_1}
            \caption{\\ Diagonal DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_2_2}
            \caption{\\ Diagonal DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_2_3}
            \caption{\\ Diagonal DO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Diagonal DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Horizontal DO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_3_2}
            \caption{\\ Horizontal DO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_3_3}
            \caption{\\ Horizontal DO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Horizontal DO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \par \bigskip
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Non-Oriented SO \\ \& Verical DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Non-Oriented SO \\ \& Diagonal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Non-Oriented SO \\ \& Horizontal DO}
    \end{subfigure}%
    \begin{subfigure}[b]{0.2\textwidth}
            \centering
            \captionsetup{justification=centering}
            \includegraphics[width=.85\linewidth]{w_blank}
            \caption{\\ Non-Oriented SO \\ \& Non-Oriented SO}
    \end{subfigure}%
    \caption{Graphical representation of \textit{inhibitory} interaction weights ($W$) between vertical, diagonal, and horizontal double-opponent cells and single-opponent cells.}
\end{figure}

\subsubsection*{Scale ($\sigma$)}
As in Penacchio \cite{penacchio:2013}, we decompose the input signal into signal at different scales. This reflect single-opponent and double-opponent cells' spatial frequency selectivity derived from their receptive fields. While this confers a level of scale invariance to the model, the primate visual cortex is not completely scale invariant and nor should our model be. Both image transformation methods presented in Stage I inherently represent activity at lower spatial frequencies with higher response.

\subsubsection*{Color ($\gamma$)}
We introduce a novel concept to the neurodynamical model framework developed by Li \cite{li:1999} and Penacchio \cite{penacchio:2013}: color. Unfortunately, the structural organization of color preferring cells and the connections between them is not well understood and leading theories are still quite controversial \cite{shapley:2011}. We herein define a set of \textit{logical} rules of interaction opponent color cells (including achromatic cells).

If a cell is stimulated, it excites nearby cells of the same orientation and scale preference, in any color channel other than its opponent. Conversely, a stimulated cell will inhibit nearby cells of the same orientation and scale preference, only in its opponent color channel. For example, stimulation of a DO cell preferring 'yellow' vertical edges will excite a DO cell preferring 'red' vertical edges at the same location. It will equally excite 'green', 'light', and 'dark' cells preferring the same orientation in the same location. It will not, however, excite cells of its opponent color 'blue'. In fact, it will inhibit activity in 'blue' cells preferring this same orientation in the same location.

We propose that these rules of interaction are logical as only opponent colors are mutually exclusive. While a bluish yellow line is not permissible in the opponent colorspace, a bluish green, bluish red, bright blue, or dark blue line is entirely plausible. Each of the possible combinations are equally probable and so the excitatory-excitatory connections between cells of these color preferences are equally weighed. These excitatory and inhibitory rules are encoded in $J$ and $W$, respectively.

\subsubsection*{Activity Normalization ($I_0$)}
The general and local normalization of activities \cite{heeger:1992} has been extended from its used by Li \cite{li:1999} and Penacchio \cite{penacchio:2013}. We normalize excitatory membrane potentials within double-opponent cells of similar location ($i$), color ($\gamma$), scale ($\sigma$), and orientation ($\theta$) preferences. Likewise we normalize single-opponent cells of similar location ($i$), color ($\gamma$), scale ($\sigma$). We found it important to normalize the activity of these two classes of neurons independently as the information encoded by each is radically different: localized edge information by double-opponent cells, and extensive surface information by single-opponent cells.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% EXPERIMENTS
%
% In which we describe the computational experiments employed,
% the psychophysical results expected, and the reasoning
% behind these expectations.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Experiments}

\begin{figure}[h] \label{fig:crispening-effect}
    \centering
        \begin{subfigure}[b]{0.2\textwidth}
                \centering
                \frame{\includegraphics[width=.85\linewidth]{crisp_1}}
                \caption{}
                \label{fig:crispening-effect-a}
        \end{subfigure}%
        \begin{subfigure}[b]{0.2\textwidth}
                \centering
                \frame{\includegraphics[width=.85\linewidth]{crisp_2}}
                \caption{}
                \label{fig:crispening-effect-b}
        \end{subfigure}%
        \begin{subfigure}[b]{0.2\textwidth}
                \centering
                \frame{\includegraphics[width=.85\linewidth]{crisp_3}}
                \caption{}
                \label{fig:crispening-effect-c}
        \end{subfigure}
        \caption{Example of the 'Crispening Effect'; the lightness contrast between two patches becomes most significant when placed on a background whose luminance lies between those of the patches.}
\end{figure}


\subsection*{Analyze Data Transformation}
\begin{itemize}
    \item Opponent Receptive Fields
    \begin{itemize}
        \item does SO behave as expected
        \item does DO behave as expected
        \item does Itti space behave as expected
    \end{itemize}
    \item DWT
    \begin{itemize}
        \item does SO behave as expected (as Itti?)
        \item does DO behave as expected
        \item (L*a*b* is trusted)
    \end{itemize}
    \item What are the differences between these outputs?
    \begin{itemize}
        \item Show side by side LDRGBY/LAB+- convolutions
    \end{itemize}
    \item What are general shortcomings?
    \begin{itemize}
        \item OFF receptive fields function in time: removing green excites red. Our RFs don't reflect this.
    \end{itemize}
\end{itemize}

\subsection*{Analyze Neurodynamical Model}
\begin{itemize}
    \item We can trust the concept because of Otazu 2013
    \item We need to analyze how color works
    \begin{itemize}
        \item Connections between color channels
        \begin{itemize}
            \item What are our assumptions? (\& why?)
            \item How does it modify the results over no connections?
            \item How does it modify the results over full connections (including between opponents)?
        \end{itemize}
        \item Connections between SO and DO
    \end{itemize}
\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% RESULTS
%
% A presentation and review of the experiments to which the
% model was subjected.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results}

\textit{TODO}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% CONCLUSIONS
%
% A summary of the of the achievements of this work, given the
% initially stated problem and hypothesis. Here we also overview
% open research lines following our findings.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}

\textit{TODO}


\appendices
\section{Appendix title}
\textit{TODO}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% ACKNOWLEDGEMENTS
%
% Where we extend thanks to those involved in this project.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgment}

\textit{The authors would like to thank...}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% NOTES
%
% My notes for writing this paper. To be deleted!
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Notes}
\subsection*{State of the Art - Biology - Notes:}
\begin{enumerate}
    \item What is color?
        \begin{itemize}
            \item Subjective
            \item Correlates to reflectance patterns
        \end{itemize}
    \item Historical view $\rightarrow$ separation of color \& shape
        \begin{itemize}
            \item Parallel/modular/segregated processing \cite{chualupa:encyclopedia}
            \item Intuitive
            \begin{itemize}
                \item Black \& white movies work fine (Shapley 2011)
                \item Full field color can be seen fine
            \end{itemize}
            \begin{itemize}
                \item LGN research suggested parvicellular \& konicellular has color, magnocellular has contrast (edges)
                \item Similarly, V5 was 'motion'
            \end{itemize}
        \end{itemize}
    \item Current view $\rightarrow$ integration of color \& shape
        \begin{itemize}
            \item All information is processed as one information stream (too strong??)
            \item Color opponency
                \begin{itemize}
                    \item Discuss LMS \& opponent color theory
                    \item Retinal receptive fields \& horizontal cells
                    \item LGN information reflects opponent colors (no spatial opponency)
                    \item SINGLE OPPONENT CELLS RESPOND BEST TO FULL FIELD COLOR
                \end{itemize}
            \item Spatial opponency
                \begin{itemize}
                    \item LGN information upgraded to include spatial opponency
                    \item Double-opponent cells: color \& spatially opponent
                    \item Spatial frequency sensitivity
                    \item Orientation sensitivity
                    \item Shapley shows most V1 cells are double-opponent
                    \item DOUBLE OPPONENT CELLS RESPOND BEST TO COLOR BOUNDARIES
                \end{itemize}
            \item DO \& SO roles
                \begin{itemize}
                    \item If there are SO cells in V1, they aren't just a stepping stone, but encode valuable information. Thus, they likely work in concert with DO cells (more numerous (Shapley))
                    \item DO cells detect edges $\rightarrow$ saliency? (Z. Li)
                \end{itemize}
            \item Interactions (hypercolumns, CO blobs, etc.)
                \begin{itemize}
                    \item Not well understood =(
                    \item Retinotopic
                    \item Hypercolumns (Z. Li?)
                    \item What does Shapley think of CO blobs (youtube Q \& A)?
                \end{itemize}
        \end{itemize}
\end{enumerate}

\subsection*{Method - DWT \& L*a*b* - Notes:}
\begin{itemize}
    \item Process:
    \begin{itemize}
        \item Convert image from RGB to L*a*b*
        \item Subtract 50 from L* to center it on 0 (a* and b* are already zero centered)
        \item Apply DWT at each scale
    \end{itemize}
    \begin{enumerate}
        \item the wavelet signal at each scale is the DO response in that channel
        \item the wavelet residual at each scale is the SO response in the channel
    \end{enumerate}
    \begin{itemize}
        \item To recover R, G, B, Y, L, \& D we take positive and negative values of the R-G, B-Y, \& L-D channels.
    \end{itemize}
    \item This implementation comes with obvious deviations from the biology:
    \begin{enumerate}
        \item By transforming RGB to L*a*b* at the pixel level, we lose receptive field integration
        \item The brain doesn't translate to opponent colors and then find edges
        \begin{itemize}
            \item this can be formalized as the difference between
            \begin{enumerate}
                \item the addition of convolutions
                \item the convolution of additions
            \end{enumerate}
        \end{itemize}
    \end{enumerate}
    \item What are the advantages?
    \begin{enumerate}
        \item Computationally efficient \& relatively fast
        \item ...?
    \end{enumerate}
\end{itemize}


% Can use something like this to put references on a page
% by themselves when using end float and the captions off option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
\begin{thebibliography}{1}

\bibitem{itti:1998}
    Laurent Itti, Christof Koch, and Ernst Niebur.
    \emph{A Model of Saliency-Based Visual Attention for Rapid Scene Analysis}.
    IEEE Transactions on Pattern Analysis and Machine Intelligence, 20.11 (1999). 1254-1259.
  
\bibitem{li:1998}
  Zhaoping Li.
  \emph{A Neural Model of Contour Integration in the Primary Visual Cortex}.
  Neural Computation 10.4 (1998): 903-40.

\bibitem{li:1999}
  Zhaoping Li.
  \emph{Visual Segmentation by Contextual Influences via Intra-cortical Interactions in the Primary Visual Cortex}.
  Network: Computation in Neural Systems 10.2 (1999): 187-212.

\bibitem{penacchio:2013}
  Olivier Penacchio, Xavier Otazu, and Laura Dempere-Marco.
  \emph{A Neurodynamical Model of Brightness Induction in V1}.
  PLoS ONE 8.5 (2013): E64086.

\bibitem{chualupa:encyclopedia}
  Shapley, Robert, Michael Hawken, and Elizabeth Johnson.
  \emph{Color in the Primary Visual Cortex}.
  The Visual Neurosciences. Vol. 2.
  Cambridge, Mass.: MIT, 2004.
  568-86.

\bibitem{spitzer:2005}
    Hedva Spitzer, Yuval Barkan.
    \emph{Computational adaptation model and its predictions for color induction of first and second orders}.
    Vision Research 45.27 (2005). 3323â3342.

\bibitem{zhang:2012}
    Jun Zhang, Youssef Barhomi, and Thomas Serre.
    \emph{A new biologically inspired color image descriptor}.
    Computer Vision â ECCV 2012
    Lecture Notes in Computer Science Volume 7576, 2012, pp 312-324.
    
\end{thebibliography}

% biography section
% 
% If you have an EPS/PDF photo (graphics package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}

% that's all folks
\end{document}


